<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>pixabay4-fetch</title>
  <style>
    .result-container {
      border-top: 3px solid #000;
      margin-top: 20px;
    }
  </style>
  <script src="../common/jquery-3.7.0.min.js"></script>
</head>

<body>
  <form>
    <input type="search" id="search-item">
    <button type="submit" id="search-btn">검색</button>
  </form>
  <div class="result-container">
  </div>

  <script>

    const searchPixabay = (value) => {
      const API_KEY = '37039658-cc9d56ed8b70fbcc207974509';
      const URL = `https://pixabay.com/api/?key=${API_KEY}&q=${encodeURIComponent(value)}`;

      fetch(URL)
        .then(res => res.json())
        .then(data => {
          console.log(data.hits)

          // 기존 검색 결과 비움
          $('.result-container').empty();

          data.hits.forEach(image => {
            const previewURL = image.previewURL;

            const img = $('<img>').attr({
              'src': previewURL, 'alt': image.tags
            });

            $('.result-container').append(img);
          });

          // 검색 후 입력란 비움
          $('#search-item').val('');

        })
        // 생략 가능
        .catch(err => console.log('에러', err));
    }

    $('#search-btn').on('click', function (e) {
      e.preventDefault();

      // .val(); 인풋의 입력값을 가져오거나 리턴
      const userValue = $('#search-item').val();

      // if문을 안주면 검색어 없이도 출력이 나옴
      if (userValue.length > 0) {
        searchPixabay(userValue);
      }

    });
  </script>
</body>

</html>